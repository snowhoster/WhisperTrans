# 語言選單更新說明

## 更新內容

語言選擇下拉選單已更新為中文顯示，提供更直觀的使用者體驗。

## 變更詳情

### 1. 界面更新

#### 之前
```xaml
<ComboBoxItem Content="自動偵測"/>
<ComboBoxItem Content="zh"/>
<ComboBoxItem Content="en"/>
<ComboBoxItem Content="ja"/>
<ComboBoxItem Content="ko"/>
```

#### 之後
```xaml
<ComboBoxItem Content="自動偵測" Tag="auto"/>
<ComboBoxItem Content="繁體中文" Tag="zh"/>
<ComboBoxItem Content="英文" Tag="en"/>
<ComboBoxItem Content="日文" Tag="ja"/>
<ComboBoxItem Content="韓文" Tag="ko"/>
<ComboBoxItem Content="簡體中文" Tag="zh-CN"/>
<ComboBoxItem Content="法文" Tag="fr"/>
<ComboBoxItem Content="德文" Tag="de"/>
<ComboBoxItem Content="西班牙文" Tag="es"/>
<ComboBoxItem Content="俄文" Tag="ru"/>
```

### 2. 預設語言

- **預設選擇**: 繁體中文
- **SelectedIndex**: 從 0 改為 1（繁體中文）

### 3. 程式碼更新

新增 `GetSelectedLanguage()` 輔助方法：

```csharp
private string? GetSelectedLanguage()
{
    if (LanguageComboBox.SelectedItem is ComboBoxItem item)
    {
        var tag = item.Tag?.ToString();
        return tag == "auto" ? null : tag;
    }
    return "zh"; // 預設繁體中文
}
```

在初始化時使用：

```csharp
var config = new WhisperConfig
{
    ModelPath = modelPath,
    Language = GetSelectedLanguage(),  // 使用輔助方法取得語言代碼
    // ...
};
```

## 支援的語言

### 常用語言

| 顯示名稱 | 語言代碼 | 說明 |
|---------|----------|------|
| 自動偵測 | null | Whisper 自動識別語言 |
| 繁體中文 | zh | 預設選擇 ? |
| 英文 | en | 英語 |
| 日文 | ja | 日語 |
| 韓文 | ko | 韓語 |

### 新增語言

| 顯示名稱 | 語言代碼 | 說明 |
|---------|----------|------|
| 簡體中文 | zh-CN | 簡體中文 |
| 法文 | fr | 法語 |
| 德文 | de | 德語 |
| 西班牙文 | es | 西班牙語 |
| 俄文 | ru | 俄語 |

## 使用者界面

```
┌─────────────────────────────────────┐
│ 語言: [繁體中文 ▼]                   │
│       └─ 自動偵測                   │
│       └─ 繁體中文 ?               │
│       └─ 英文                       │
│       └─ 日文                       │
│       └─ 韓文                       │
│       └─ 簡體中文                   │
│       └─ 法文                       │
│       └─ 德文                       │
│       └─ 西班牙文                   │
│       └─ 俄文                       │
└─────────────────────────────────────┘
```

## 技術實作

### 1. XAML 結構

使用 `Tag` 屬性存儲實際的語言代碼：

```xaml
<ComboBoxItem Content="繁體中文" Tag="zh"/>
```

- `Content`: 使用者看到的文字（中文）
- `Tag`: 傳遞給 Whisper 的語言代碼（ISO 639-1）

### 2. 語言代碼映射

| Tag 值 | Whisper 處理 | 說明 |
|--------|--------------|------|
| `auto` | `null` | 觸發自動語言偵測 |
| `zh` | `"zh"` | 繁體中文/簡體中文 |
| `zh-CN` | `"zh"` | 簡體中文（特定） |
| `en` | `"en"` | 英文 |
| 其他 | 原值 | 直接傳遞給 Whisper |

### 3. 向下相容

如果無法讀取 Tag 屬性，預設返回 `"zh"`：

```csharp
private string? GetSelectedLanguage()
{
    if (LanguageComboBox.SelectedItem is ComboBoxItem item)
    {
        var tag = item.Tag?.ToString();
        return tag == "auto" ? null : tag;
    }
    return "zh"; // 向下相容：預設繁體中文
}
```

## 使用範例

### 選擇繁體中文（預設）
```
使用者看到: "繁體中文"
傳遞給 Whisper: "zh"
結果: 轉錄繁體中文語音
```

### 選擇自動偵測
```
使用者看到: "自動偵測"
傳遞給 Whisper: null
結果: Whisper 自動識別語言
```

### 選擇英文
```
使用者看到: "英文"
傳遞給 Whisper: "en"
結果: 轉錄英文語音
```

## Whisper 語言支援

Whisper 支援 90+ 種語言，以下是完整列表中的部分常用語言：

### 亞洲語言
- 中文 (Chinese) - `zh`
- 日文 (Japanese) - `ja`
- 韓文 (Korean) - `ko`
- 泰文 (Thai) - `th`
- 越南文 (Vietnamese) - `vi`

### 歐洲語言
- 英文 (English) - `en`
- 法文 (French) - `fr`
- 德文 (German) - `de`
- 西班牙文 (Spanish) - `es`
- 義大利文 (Italian) - `it`
- 俄文 (Russian) - `ru`

### 如何新增更多語言

在 `MainWindow.xaml` 中新增 ComboBoxItem：

```xaml
<ComboBoxItem Content="泰文" Tag="th"/>
<ComboBoxItem Content="越南文" Tag="vi"/>
<ComboBoxItem Content="印尼文" Tag="id"/>
```

不需要修改任何程式碼，系統會自動處理！

## 最佳實踐

### 1. 已知語言時
選擇特定語言可以提高準確度：
```
繁體中文內容 → 選擇「繁體中文」
英文內容 → 選擇「英文」
```

### 2. 混合語言時
使用自動偵測：
```
中英混合 → 選擇「自動偵測」
```

### 3. 不確定語言時
使用自動偵測，但可能稍慢：
```
未知語言 → 選擇「自動偵測」
```

## 注意事項

1. **語言代碼**: 使用 ISO 639-1 標準（兩字母代碼）
2. **中文處理**: `zh` 同時支援繁體和簡體
3. **自動偵測**: 會稍微增加處理時間
4. **模型支援**: 所有官方 Whisper 模型都支援多語言

## 疑難排解

### Q: 選擇繁體中文但轉錄結果是簡體？
A: Whisper 的 `zh` 代碼同時支援繁簡體，輸出格式取決於模型訓練資料。可以透過後處理轉換。

### Q: 自動偵測為何比指定語言慢？
A: 自動偵測需要先分析音訊樣本來識別語言，增加了處理步驟。

### Q: 如何新增自訂語言？
A: 在 XAML 中新增 ComboBoxItem，使用正確的 ISO 639-1 語言代碼作為 Tag。

### Q: 語言代碼從哪裡取得？
A: 參考 [ISO 639-1 語言代碼列表](https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes)

## 更新日誌

### v1.1.1 - 語言選單中文化
- ? 語言選單使用中文顯示
- ? 預設選擇繁體中文
- ? 新增更多常用語言選項
- ? 使用 Tag 屬性存儲語言代碼
- ? 新增 GetSelectedLanguage() 輔助方法
- ? 完整的向下相容支援

## 相關連結

- [Whisper 支援的語言列表](https://github.com/openai/whisper#available-models-and-languages)
- [ISO 639-1 語言代碼](https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes)
- [Whisper.NET 文件](https://github.com/sandrohanea/whisper.net)

---

**版本**: 1.1.1  
**最後更新**: 2024
